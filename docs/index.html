<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extract Climate Data From a Local or online NETCDF   • climateExtract</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Extract Climate Data From a Local or online NETCDF  ">
<meta property="og:description" content="A toolbox to extract and wrangle daily gridded climate data from NETCDF objects available from the European Climate Assessement &amp; Datasets (ECAD) for specific time period, compute summarized values and link them to set of spatial points.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-154857767-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-154857767-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">climateExtract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.29</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RetoSchmucki/climateExtract/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level3">
<h3 id="climateextract-">climateExtract <img src="reference/figures/logo.png" align="right" alt="" width="120"><a class="anchor" aria-label="anchor" href="#climateextract-"></a>
</h3>
<!-- badges: start -->

</div>
<div class="section level3">
<h3 id="r-functions-to-extract-and-manipulate-ecad-climate-data">R functions to extract and manipulate ECAD climate data<a class="anchor" aria-label="anchor" href="#r-functions-to-extract-and-manipulate-ecad-climate-data"></a>
</h3>
<ul>
<li>ECAD at <a href="https://surfobs.climate.copernicus.eu/dataaccess/access_eobs.php#datafiles" class="external-link">Copernicus Climate</a>
</li>
<li>Package URL: <a href="https://retoschmucki.github.io/climateExtract" class="external-link">https://retoschmucki.github.io/climateExtract/</a>
</li>
</ul>
<blockquote>
<p>Before extracting any data, please read carefully the description of the datasets and the different grid size available (eg. 0.25 deg. regular grid, “TG” average temperature). Note shorter time-series are also available <a href="https://surfobs.climate.copernicus.eu/dataaccess/access_eobs.php#datafiles" class="external-link">Copernicus Climate</a></p>
</blockquote>
<div class="section level4">
<h4 id="news">News<a class="anchor" aria-label="anchor" href="#news"></a>
</h4>
<ul>
<li>24/04/2024 (“Roman-Rose”)
<ul>
<li>Updated to E-OBS v29.0 (March 2024)
<ol style="list-style-type: decimal">
<li>extending data from January 1950 to December 2023</li>
<li>fixed bug small negative values in ggd “be” method</li>
</ol>
</li>
</ul>
</li>
<li>07/11/2023 (“Mountain-Rose”)
<ul>
<li>Updated to E-OBS v28.0 (Oct 2023)
<ol style="list-style-type: decimal">
<li>extending data from January 1950 to June 2023</li>
<li>fully update to the <code>terra</code> package</li>
<li>included the <code>geodata</code> package</li>
<li>removed former dependency to the <code>zoo</code> package</li>
</ol>
</li>
</ul>
</li>
<li>30/04/2023 (“Witty-Rose”)
<ul>
<li>Updated to E-OBS v27.0 (April 2023)
<ol style="list-style-type: decimal">
<li>extending data from January 1950 to December 2022</li>
</ol>
</li>
</ul>
</li>
<li>16/06/2022 (“Curious-Rose”)
<ul>
<li>Updated to E-OBS v25.0 (June 2022)
<ol style="list-style-type: decimal">
<li>extending data from January 1950 to December 2021</li>
<li>Fixed a bug in GDD producing NA when minimum and maximum temperatures were the same.</li>
</ol>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h4>
<p>GitHub installation (CRAN not available)</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"RetoSchmucki/climateExtract"</span><span class="op">)</span></span></code></pre>
<p>Dependencies: <code>ncdf4</code>, <code>data.table</code>, <code>sf</code>, <code>terra</code>,<code>lubridate</code>, and <code>methods</code></p>
</div>
<div class="section level4">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h4>
<p>Check the default ECAD version (can be changed with <code>ecad_v = xx.x</code>)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://retoschmucki.github.io/climateExtract" class="external-link">climateExtract</a></span><span class="op">)</span></span>
<span><span class="va">ecad_version</span></span></code></pre></div>
<p>Define specific regions and points. If not provided, the function will extract the data for the entire extent of ECAD. Note that we need to install the package <code>geodata</code> to retrieve the border of France.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use set.seed() for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42876</span><span class="op">)</span> </span>
<span><span class="va">fr_border</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu">geodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geodata/man/gadm.html" class="external-link">gadm</a></span><span class="op">(</span><span class="st">"GADM"</span>, country <span class="op">=</span> <span class="st">"FRA"</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sf_point</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fr_border</span>, size <span class="op">=</span> <span class="fl">25</span>, type <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Extract data - Retrieve climate data from E-OBS server or a local file if available. - Crop to the extent of the spatial object provided. - Specify years and data of interest; see details help(extract_nc_value). - Write output to local disk with <code>write_raster=TRUE</code> - If <code>return_data = TRUE</code>, an R object (a list) with the climate values is created.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">climate_data</span> <span class="op">=</span> <span class="fu"><a href="reference/extract_nc_value.html">extract_nc_value</a></span><span class="op">(</span>first_year <span class="op">=</span> <span class="fl">2012</span>, </span>
<span>                                last_year <span class="op">=</span> <span class="fl">2015</span>,</span>
<span>                                local_file <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                file_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                sml_chunk <span class="op">=</span> <span class="st">"2011-2023"</span>,</span>
<span>                                spatial_extent <span class="op">=</span> <span class="va">fr_border</span>,</span>
<span>                                clim_variable <span class="op">=</span> <span class="st">"mean temp"</span>,</span>
<span>                                statistic <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                                grid_size <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                                ecad_v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                write_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                out <span class="op">=</span> <span class="st">"raster_mean_temp.tiff"</span>,</span>
<span>                                return_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Connect to the raster brick created on the local disk. If it is too big to be stored in Memory, the terra package will set a pointer to the file.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbk</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"raster_mean_temp.tiff"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">climate_data</span><span class="op">)</span>, <span class="st">"MB"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">rbk</span><span class="op">)</span>, <span class="st">"MB"</span><span class="op">)</span></span></code></pre></div>
<p>Aggregate the data over time; <code>annual</code>, <code>monthly</code>, or by using a rolling <code>window</code>. The function <code>mean</code> could be replaced by <code>sum</code>, <code>sd</code>, or other functions that can be computed along a vector. If you select “daily” for the time_step, the function will return the daily ECAD data without aggregation. Note that when computing rolling</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># monthly mean</span></span>
<span><span class="va">monthly_avg_temp_R</span> <span class="op">=</span> <span class="fu"><a href="reference/temporal_aggregate.html">temporal_aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rbk</span>,</span>
<span>                                        agg_function <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                                        variable_name <span class="op">=</span> <span class="st">"average temp"</span>,</span>
<span>                                        time_step <span class="op">=</span> <span class="st">"monthly"</span><span class="op">)</span></span>
<span><span class="co"># annual mean</span></span>
<span><span class="va">annual_avg_temp_R</span> <span class="op">=</span> <span class="fu"><a href="reference/temporal_aggregate.html">temporal_aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rbk</span>,</span>
<span>                                       agg_function <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                                       variable_name <span class="op">=</span> <span class="st">"average temp"</span>,</span>
<span>                                       time_step <span class="op">=</span> <span class="st">"annual"</span><span class="op">)</span></span>
<span><span class="co"># 7-day rolling mean</span></span>
<span><span class="va">window_7d_avg_temp_R</span> <span class="op">=</span> <span class="fu"><a href="reference/temporal_aggregate.html">temporal_aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rbk</span>,</span>
<span>                                          agg_function <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>                                          variable_name <span class="op">=</span> <span class="st">"average temp"</span>,</span>
<span>                                          time_step <span class="op">=</span> <span class="st">"window"</span>,                                          ,</span>
<span>                                          win_length <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Note: Argument in <code>x</code> could also be the climate_data object that resulted from the <code><a href="reference/extract_nc_value.html">extract_nc_value()</a></code> function.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="extract-location-specific-value">Extract location-specific value<a class="anchor" aria-label="anchor" href="#extract-location-specific-value"></a>
</h2>
<p>You can provide a set of spatial locations (e.g., points) in the <code>y</code> argument to extract the values for these locations. By providing geographic locations in <code>y</code>, the function return the results, the temporal aggregates, specific to these points.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># annual mean per point</span></span>
<span><span class="va">annual_avg_temp_pnts</span> <span class="op">=</span> <span class="fu"><a href="reference/temporal_aggregate.html">temporal_aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rbk</span>,</span>
<span>                                          y <span class="op">=</span> <span class="va">sf_point</span>,</span>
<span>                                          agg_function <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                                          variable_name <span class="op">=</span> <span class="st">"average temp"</span>,</span>
<span>                                          time_step <span class="op">=</span> <span class="st">"annual"</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Note: If a site is located along the coast and falls outside the terrestrial part of the raster grid cell with a value, the function return the value of the nearest cell with a value. This will also return the Distance_from_pnt to inform the distance between the location and the centroid of the cell from which the value was collected. For points located on grid cell with value, the Distance_from_pnt is NA.</p>
</blockquote>
<p>Map of the aggregated layer. For a map of the average temperature for Sept 2012, use layer <code>"2012-09"</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">monthly_avg_temp_R</span><span class="op">[[</span><span class="st">"2012-09"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Add points to the map.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">monthly_avg_temp_R</span><span class="op">[[</span><span class="st">"2012-09"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sf_point</span>, col <span class="op">=</span> <span class="st">'magenta'</span>, pch <span class="op">=</span> <span class="fl">17</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="growing-degree-day-gdd">Growing Degree Day (GDD)<a class="anchor" aria-label="anchor" href="#growing-degree-day-gdd"></a>
</h4>
<p>ClimateExtract enables users to calculate growing degree day values with specific base and maximum temperatures. You can calculate the GDD from the daily average temperature or use the Baskerville-Emin method (method = ‘be’), which fits a sine function to the minimum and maximum daily temperature to account for daily fluctuations. With these methods, you can calculate daily GDD values and compute the total or the cumulative sum (accumulated) GDD over a specific period (e.g., year, month, week, or a moving window).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get minimum temperature </span></span>
<span></span>
<span><span class="va">climate_data_min</span> <span class="op">=</span> <span class="fu"><a href="reference/extract_nc_value.html">extract_nc_value</a></span><span class="op">(</span>first_year <span class="op">=</span> <span class="fl">2012</span>, </span>
<span>                                    last_year <span class="op">=</span> <span class="fl">2015</span>,</span>
<span>                                    local_file <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                    file_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                    sml_chunk <span class="op">=</span> <span class="st">"2011-2023"</span>,</span>
<span>                                    spatial_extent <span class="op">=</span> <span class="va">fr_border</span>,</span>
<span>                                    clim_variable <span class="op">=</span> <span class="st">"min temp"</span>,</span>
<span>                                    statistic <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                                    grid_size <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                                    ecad_v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                    write_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                    out <span class="op">=</span> <span class="st">"raster_min_temp.tiff"</span>,</span>
<span>                                    return_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">climate_data_max</span> <span class="op">=</span> <span class="fu"><a href="reference/extract_nc_value.html">extract_nc_value</a></span><span class="op">(</span>first_year <span class="op">=</span> <span class="fl">2012</span>,</span>
<span>                                    last_year <span class="op">=</span> <span class="fl">2015</span>,</span>
<span>                                    local_file <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                    file_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                    sml_chunk <span class="op">=</span> <span class="st">"2011-2023"</span>,</span>
<span>                                    spatial_extent <span class="op">=</span> <span class="va">fr_border</span>,</span>
<span>                                    clim_variable <span class="op">=</span> <span class="st">"max temp"</span>,</span>
<span>                                    statistic <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                                    grid_size <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                                    ecad_v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                    write_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                    out <span class="op">=</span> <span class="st">"raster_max_temp.tiff"</span>,</span>
<span>                                    return_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rbk_min</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"raster_min_temp.tiff"</span><span class="op">)</span></span>
<span><span class="va">rbk_max</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"raster_max_temp.tiff"</span><span class="op">)</span></span></code></pre></div>
<p>With the <code><a href="reference/gdd_extract.html">gdd_extract()</a></code> function, we can calculate the GDD with a specific base temperature (7 degrees C) and a preferred method. Here, we used the Baskerville-Emin method (method = ‘be’), which requires the minimum and maximum daily temperatures. You can also use the average daily temperature by using the method to <code>avg</code> instead of <code>be</code>. Note that for the average method, you can specify the mean_temp or provide the min_temp and max_temp from which the function calculates the mean temperature. When using the <code>be</code> method, you must provide the minimum and maximum temperature to enable the fit of a daily sine function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">be_gdd_france</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gdd_extract.html">gdd_extract</a></span><span class="op">(</span>base_temp <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                            min_temp <span class="op">=</span> <span class="va">rbk_min</span>,</span>
<span>                            max_temp <span class="op">=</span> <span class="va">rbk_max</span>,</span>
<span>                            gdd_method <span class="op">=</span> <span class="st">'be'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualise the GDD-base7, for June 16th 2012</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">be_gdd_france</span><span class="op">[[</span><span class="st">"2012-06-16"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The output is a multilayer raster that you can use with the function <code><a href="reference/temporal_aggregate.html">temporal_aggregate()</a></code> to calculate the sum, mean, or rolling window mean. In general, however, we will be most interested in the cumulative sum (i.e., the accumulation of GDD over a specific period). You can use the function <code><a href="reference/cumsum_rb.html">cumsum_rb()</a></code> (cumulative sum on multilayer raster). This function uses the GDD Raster and a vector that indexes the layers to inform the specific period (e.g., monthly, yearly, weekly, or X-day windows). The indices are returned with the function <code><a href="reference/get_layer_indice.html">get_layer_indice()</a></code> (see below). You can also provide a vector of index that will be used to aggregate the layers.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tp_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_layer_indice.html">get_layer_indice</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">be_gdd_france</span>,</span>
<span>                             date_format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span>,</span>
<span>                             indice_level <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">year_cumsum_gdd_france</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cumsum_rb.html">cumsum_rb</a></span><span class="op">(</span><span class="va">be_gdd_france</span>, indices <span class="op">=</span> <span class="va">tp_index</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualise the GDD base7 accumulated between January 1st until June 16th 2012.</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">year_cumsum_gdd_france</span><span class="op">[[</span><span class="st">"2012-06-16"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>To get the cumulative GDD at the end of each month, you can calculate the cumulative total monthly and extract the last day of each month. The following script generates a RasterBrick of the total GDD accumulated at the end of each month.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tp_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_layer_indice.html">get_layer_indice</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">be_gdd_france</span>,</span>
<span>                             date_format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span>,</span>
<span>                             indice_level <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">month_cumsum_gdd_france</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cumsum_rb.html">cumsum_rb</a></span><span class="op">(</span><span class="va">be_gdd_france</span>, indices <span class="op">=</span> <span class="va">tp_index</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the indices for the last day of each month - calculate the number of day in each month along the time-series</span></span>
<span><span class="va">last_day_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">floor_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">month_cumsum_gdd_france</span><span class="op">)</span>, <span class="st">"%Y-%m-%d"</span><span class="op">)</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">month_cumsum_gdd_france</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">last_day_index</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># plot the accumulated gdd on January 31 and Feburary 29, 2012</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">month_cumsum_gdd_france</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">last_day_index</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="meta">Meta<a class="anchor" aria-label="anchor" href="#meta"></a>
</h4>
<ul>
<li><p>See citation and ECA&amp;D/E-OBS data policy <a href="https://surfobs.climate.copernicus.eu/dataaccess/access_eobs.php#datafiles" class="external-link">https://surfobs.climate.copernicus.eu/dataaccess/access_eobs.php#datafiles</a></p></li>
<li><p>Register as an E-OBS user at <a href="https://surfobs.climate.copernicus.eu/dataaccess/registration.php" class="external-link uri">https://surfobs.climate.copernicus.eu/dataaccess/registration.php</a></p></li>
<li><p>Package URL: <a href="https://retoschmucki.github.io/climateExtract" class="external-link">https://retoschmucki.github.io/climateExtract/</a></p></li>
<li><p>Raise issues: <a href="https://github.com/RetoSchmucki/climateExtract/issues" class="external-link">https://github.com/RetoSchmucki/climateExtract/issues</a></p></li>
<li><p>Get citation information for <code>climateExtract</code> in R doing <code>citation(package = 'climateExtract')</code></p></li>
<li>
<p>Suggested citation:</p>
<ul>
<li>Schmucki R. (2024) climateExtract: Extract and manipulate daily gridded observational dataset of European climate (E-OBS) provided by ECA&amp;D. R package version 1.29. <a href="https://github.com/RetoSchmucki/climateExtract" class="external-link uri">https://github.com/RetoSchmucki/climateExtract</a>
</li>
</ul>
</li>
</ul>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/RetoSchmucki/climateExtract/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/RetoSchmucki/climateExtract/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing climateExtract</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Reto Schmucki <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3064-7553" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.travis-ci.com/RetoSchmucki/climateExtract" class="external-link"><img src="https://app.travis-ci.com/RetoSchmucki/climateExtract.svg?branch=master" alt="Build Status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Reto Schmucki.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
